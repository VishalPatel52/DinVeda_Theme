{% comment %}
  DinVeda Hero - Premium full-width hero with gradient overlay
  German-first homepage hero section
  Always renders with fallback background if no image is set
{% endcomment %}

{%- liquid
  assign hero_image = section.settings.image
  assign hero_image_url = section.settings.image_url
  assign overlay_opacity = section.settings.overlay_opacity | default: 50
  assign min_height_desktop = section.settings.min_height_desktop | default: 640
  assign min_height_mobile = section.settings.min_height_mobile | default: 520
  
  comment
    For local testing: if no uploaded image but image_url is provided, use that
  endcomment
  if hero_image == blank and hero_image_url != blank
    assign use_url_image = true
  else
    assign use_url_image = false
  endif
-%}

<section
  id="dinveda-hero-{{ section.id }}"
  class="dinveda-hero{% unless hero_image %} dinveda-hero--no-image{% endunless %}"
  data-section-id="{{ section.id }}"
  data-section-type="dinveda-hero"
  style="--hero-min-height-desktop: {{ min_height_desktop }}px; --hero-min-height-mobile: {{ min_height_mobile }}px; --hero-overlay-opacity: {{ overlay_opacity | divided_by: 100.0 }};"
>
  <div class="dinveda-hero__wrapper">
    <div class="dinveda-hero__background{% if hero_image != blank or use_url_image %} dinveda-hero__background--has-image{% else %} dinveda-hero__background--fallback{% endif %}">
      {% if hero_image != blank %}
        <picture>
          <source
            media="(max-width: 767px)"
            srcset="{{ hero_image | image_url: width: 800 }} 1x, {{ hero_image | image_url: width: 1600 }} 2x"
          >
          <img
            src="{{ hero_image | image_url: width: 1920 }}"
            srcset="{{ hero_image | image_url: width: 1920 }} 1x, {{ hero_image | image_url: width: 3840 }} 2x"
            alt="{{ hero_image.alt | escape }}"
            class="dinveda-hero__image"
            loading="eager"
            fetchpriority="high"
            width="{{ hero_image.width }}"
            height="{{ hero_image.height }}"
          >
        </picture>
      {% elsif use_url_image %}
        <img
          src="{{ hero_image_url }}"
          alt="Hero image"
          class="dinveda-hero__image"
          loading="eager"
          fetchpriority="high"
        >
      {% endif %}
      <div class="dinveda-hero__overlay"></div>
    </div>

    <div class="dinveda-hero__content">
      <div class="dinveda-hero__inner">
        {% if section.settings.heading != blank %}
          <h1 class="dinveda-hero__heading">{{ section.settings.heading | escape }}</h1>
        {% endif %}

        {% if section.settings.subheading != blank %}
          <p class="dinveda-hero__subheading">{{ section.settings.subheading | escape }}</p>
        {% endif %}

        {% if section.settings.button_label != blank and section.settings.button_link != blank %}
          <a
            href="{{ section.settings.button_link }}"
            class="dinveda-hero__button"
          >
            {{ section.settings.button_label | escape }}
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "DinVeda Hero",
  "tag": "section",
  "class": "dynamic-section",
  "settings": [
    {
      "type": "header",
      "content": "Image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Hero image",
      "info": "Recommended: 1920x800px or similar wide ratio. If not set, a warm beige background will be shown."
    },
    {
      "type": "text",
      "id": "image_url",
      "label": "Hero image URL (for local testing)",
      "info": "Optional: Use a direct image URL for local testing. This will be used if no image is uploaded above. Example: https://images.unsplash.com/photo-..."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "default": 70,
      "info": "Controls the dark gradient overlay opacity (0-80%). Default: 70% (0.7) at bottom, 10% (0.1) at top"
    },
    {
      "type": "range",
      "id": "min_height_desktop",
      "label": "Minimum height (desktop)",
      "min": 400,
      "max": 900,
      "step": 20,
      "unit": "px",
      "default": 700,
      "info": "Minimum hero height on desktop screens"
    },
    {
      "type": "range",
      "id": "min_height_mobile",
      "label": "Minimum height (mobile)",
      "min": 300,
      "max": 700,
      "step": 20,
      "unit": "px",
      "default": 520,
      "info": "Minimum hero height on mobile screens"
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading (H1)",
      "default": "Alte Weisheit für moderne Tage"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Entdecke Bio-Rituale aus Deutschland – im Rhythmus deines Alltags."
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Jetzt starten"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    }
  ],
  "presets": [
    {
      "name": "DinVeda Hero"
    }
  ]
}
{% endschema %}
