{% comment %} DinVeda Collection Hero Section {% endcomment %}
{%- liquid
  assign hero_image = section.settings.hero_image
  if hero_image == blank and collection.image != blank
    assign hero_image = collection.image
  endif

  assign text_alignment = section.settings.text_alignment
  if text_alignment == blank
    assign text_alignment = 'center'
  endif

  assign has_image = false
  if hero_image != blank
    assign has_image = true
  endif

  assign show_text_overlay = section.settings.show_text_overlay
  if show_text_overlay == blank
    assign show_text_overlay = false
  endif

  assign heading_text = section.settings.heading
  if heading_text == blank
    assign heading_text = collection.title
  endif

  assign border_radius = section.settings.border_radius
  if border_radius == blank
    assign border_radius = 24
  endif

  assign overlay_opacity = section.settings.overlay_opacity
  if overlay_opacity == blank
    assign overlay_opacity = 40
  endif

  assign container_max_width = section.settings.container_max_width
  if container_max_width == blank
    assign container_max_width = 1400
  endif

  if section.index == 1
    assign fetchpriority = 'high'
    assign loading = 'eager'
  else
    assign loading = 'lazy'
  endif
-%}

<section
  class="dv-collection-hero dv-collection-hero-{{ section.id }} no-section-animation"
  data-section-id="{{ section.id }}"
  data-section-type="collection-hero"
>
  <div class="dv-collection-hero__wrapper">
    {% if has_image %}
      <div class="dv-collection-hero__image">
        {% render 'helper-image',
          type: hero_image,
          sm_render: '100vw',
          md_render: '100vw',
          lg_render: '100vw',
          width: 2400,
          loading: loading,
          fetchpriority: fetchpriority
        %}
        {% if show_text_overlay %}
          <div class="dv-collection-hero__overlay"></div>
        {% endif %}
      </div>
    {% endif %}

    {% if show_text_overlay %}
      <div class="dv-collection-hero__content dv-collection-hero__content--overlay a-{{ text_alignment }}">
        <div class="grid__wrapper">
          <div class="dv-collection-hero__text span-12 auto px4">
            {% if heading_text != blank %}
              <h1 class="dv-collection-hero__title">{{ heading_text }}</h1>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="dv-collection-hero__subtitle">{{ section.settings.subtitle | escape }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% else %}
      <div class="dv-collection-hero__content dv-collection-hero__content--below a-{{ text_alignment }}">
        <div class="grid__wrapper">
          <div class="dv-collection-hero__text span-12 auto px4">
            {% if heading_text != blank %}
              <h1 class="dv-collection-hero__title">{{ heading_text }}</h1>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="dv-collection-hero__subtitle">{{ section.settings.subtitle | escape }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</section>

{% style %}
  .dv-collection-hero-{{ section.id }} {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .dv-collection-hero-{{ section.id }} .dv-collection-hero__wrapper {
    position: relative;
    width: 100%;
    max-width: {{ container_max_width }}px;
    margin: 0 auto;
    border-radius: {{ border_radius }}px;
    overflow: hidden;
  }

  {% if has_image %}
    .dv-collection-hero-{{ section.id }} .dv-collection-hero__wrapper {
      max-height: 32vh;
    }

    .dv-collection-hero-{{ section.id }} .dv-collection-hero__image {
      position: relative;
      width: 100%;
      height: 32vh;
      z-index: 1;
      overflow: hidden;
    }

    .dv-collection-hero-{{ section.id }} .dv-collection-hero__image .box-ratio {
      height: 100%;
      padding-bottom: 0 !important;
    }

    .dv-collection-hero-{{ section.id }} .dv-collection-hero__image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      display: block;
    }

    {% if show_text_overlay %}
      .dv-collection-hero-{{ section.id }} .dv-collection-hero__overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
        opacity: {{ overlay_opacity | divided_by: 100.0 }};
        z-index: 2;
        pointer-events: none;
      }

      .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 3;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--design-section-spacing-large, 100px) 0;
      }

      .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--overlay .dv-collection-hero__title,
      .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--overlay .dv-collection-hero__subtitle {
        color: #ffffff;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }
    {% else %}
      .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--below {
        position: relative;
        z-index: 2;
        padding: 2.5rem 0 2rem;
        background: var(--background);
      }
    {% endif %}
  {% else %}
    .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--below {
      position: relative;
      padding: 3rem 0;
      background: var(--background);
    }
  {% endif %}

  .dv-collection-hero-{{ section.id }} .dv-collection-hero__text {
    max-width: 800px;
    margin: 0 auto;
  }

  .dv-collection-hero-{{ section.id }} .dv-collection-hero__title {
    font-family: var(--heading-family);
    font-style: var(--heading-style);
    font-weight: var(--heading-weight);
    letter-spacing: var(--heading-spacing);
    font-size: 2.5rem;
    line-height: 1.2;
    margin: 0 0 1rem;
    color: var(--design-text-color, #C17129);
  }

  .dv-collection-hero-{{ section.id }} .dv-collection-hero__subtitle {
    font-family: var(--main-family);
    font-style: var(--main-style);
    font-weight: var(--main-weight);
    font-size: 1.125rem;
    line-height: 1.5;
    margin: 0;
    color: var(--text-color);
    opacity: 0.9;
  }

  @media (max-width: 767px) {
    {% if has_image %}
      .dv-collection-hero-{{ section.id }} .dv-collection-hero__wrapper {
        max-height: 28vh;
      }

      .dv-collection-hero-{{ section.id }} .dv-collection-hero__image {
        height: 28vh;
      }

      {% if show_text_overlay %}
        .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--overlay {
          padding: 1.5rem 0;
        }
      {% else %}
        .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--below {
          padding: 2rem 0 1.5rem;
        }
      {% endif %}
    {% else %}
      .dv-collection-hero-{{ section.id }} .dv-collection-hero__content--below {
        padding: 2rem 0;
      }
    {% endif %}

    .dv-collection-hero-{{ section.id }} .dv-collection-hero__title {
      font-size: 2rem;
      margin-bottom: 0.75rem;
    }

    .dv-collection-hero-{{ section.id }} .dv-collection-hero__subtitle {
      font-size: 1rem;
    }
  }
{% endstyle %}

{% schema %}
{
  "name": "Collection hero",
  "tag": "section",
  "class": "dynamic-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image",
      "info": "Optional. If not set, uses collection image if available."
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Find balance with our curated Ayurvedic blends, guarded by ancient wisdom and modern clarity."
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "default": "center",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_text_overlay",
      "label": "Show text overlay on image",
      "default": false,
      "info": "If enabled, text appears on the image with overlay. If disabled (default), text appears below the image."
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Choose Your Ritual",
      "info": "Leave blank to use collection title. Default: Choose Your Ritual."
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Border radius",
      "default": 24,
      "info": "Rounded corners for the hero banner"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 40,
      "info": "Dark overlay opacity for text readability (0-100%)"
    },
    {
      "type": "range",
      "id": "container_max_width",
      "min": 1200,
      "max": 1600,
      "step": 50,
      "unit": "px",
      "label": "Container max width",
      "default": 1400,
      "info": "Maximum width of the hero container"
    }
  ],
  "presets": [
    {
      "name": "Collection hero"
    }
  ]
}
{% endschema %}

