{% comment %} DinVeda Cart Hero Section {% endcomment %}
{%- liquid
  assign hero_image = section.settings.hero_image

  assign text_alignment = section.settings.text_alignment
  if text_alignment == blank
    assign text_alignment = 'center'
  endif

  assign has_image = false
  if hero_image != blank
    assign has_image = true
  endif

  assign show_text_overlay = section.settings.show_text_overlay
  if show_text_overlay == blank
    assign show_text_overlay = true
  endif

  assign heading_text = section.settings.heading
  if heading_text == blank
    assign heading_text = 'Your Selections'
  endif

  assign border_radius = section.settings.border_radius
  if border_radius == blank
    assign border_radius = 0
  endif

  assign overlay_opacity = section.settings.overlay_opacity
  if overlay_opacity == blank
    assign overlay_opacity = 40
  endif

  assign container_max_width = section.settings.container_max_width
  if container_max_width == blank
    assign container_max_width = 1200
  endif

  if section.index == 1
    assign fetchpriority = 'high'
    assign loading = 'eager'
  else
    assign loading = 'lazy'
  endif
-%}

<section
  class="dinveda-cart-hero dinveda-cart-hero-{{ section.id }} no-section-animation"
  data-section-id="{{ section.id }}"
  data-section-type="cart-hero"
>
  <div class="dinveda-cart-hero__wrapper">
    {% if has_image %}
      <div class="dinveda-cart-hero__image">
        {% render 'helper-image',
          type: hero_image,
          sm_render: '100vw',
          md_render: '100vw',
          lg_render: '100vw',
          width: 2400,
          loading: loading,
          fetchpriority: fetchpriority
        %}
        {% if show_text_overlay %}
          <div class="dinveda-cart-hero__overlay"></div>
        {% endif %}
      </div>
    {% endif %}

    {% if show_text_overlay %}
      <div class="dinveda-cart-hero__content dinveda-cart-hero__content--overlay a-{{ text_alignment }}">
        <div class="grid__wrapper">
          <div class="dinveda-cart-hero__text span-12 auto px4">
            {% if heading_text != blank %}
              <h1 class="dinveda-cart-hero__title">{{ heading_text }}</h1>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="dinveda-cart-hero__subtitle">{{ section.settings.subtitle | escape }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% else %}
      <div class="dinveda-cart-hero__content dinveda-cart-hero__content--below a-{{ text_alignment }}">
        <div class="grid__wrapper">
          <div class="dinveda-cart-hero__text span-12 auto px4">
            {% if heading_text != blank %}
              <h1 class="dinveda-cart-hero__title">{{ heading_text }}</h1>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="dinveda-cart-hero__subtitle">{{ section.settings.subtitle | escape }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</section>

{% style %}
  .dinveda-cart-hero-{{ section.id }} {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__wrapper {
    position: relative;
    width: 100%;
    max-width: {{ container_max_width }}px;
    margin: 0 auto;
    {% if border_radius > 0 %}
      border-radius: {{ border_radius }}px;
    {% endif %}
    overflow: hidden;
  }

  {% if has_image %}
    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__wrapper {
      max-height: 400px;
    }

    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__image {
      position: relative;
      width: 100%;
      height: 400px;
      z-index: 1;
      overflow: hidden;
    }

    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__image .box-ratio {
      height: 100%;
      padding-bottom: 0 !important;
    }

    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      display: block;
    }

    {% if show_text_overlay %}
      .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
        opacity: {{ overlay_opacity | divided_by: 100.0 }};
        z-index: 2;
        pointer-events: none;
      }
    {% endif %}
  {% endif %}

  .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__content {
    position: relative;
    z-index: 3;
  }

  {% if show_text_overlay and has_image %}
    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__content--overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--design-section-spacing-large, 100px) 0;
    }

    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__content--overlay .dinveda-cart-hero__title,
    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__content--overlay .dinveda-cart-hero__subtitle {
      color: #ffffff;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
  {% endif %}

  .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__title {
    font-family: var(--heading-family);
    font-size: var(--design-h1-size, 3rem);
    font-weight: var(--heading-weight);
    color: var(--design-text-color, #5a4533);
    margin: 0 0 1rem 0;
    line-height: 1.2;
  }

  .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__subtitle {
    font-family: var(--main-family);
    font-size: var(--design-body-font-size, 1.125rem);
    color: var(--design-text-color, #5a4533);
    opacity: 0.9;
    margin: 0;
    line-height: 1.6;
  }

  @media screen and (max-width: 767px) {
    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__title {
      font-size: 2rem;
    }

    .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__subtitle {
      font-size: 1rem;
    }

    {% if has_image %}
      .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__wrapper {
        max-height: 300px;
      }

      .dinveda-cart-hero-{{ section.id }} .dinveda-cart-hero__image {
        height: 300px;
      }
    {% endif %}
  }
{% endstyle %}

{% schema %}
{
  "name": "DinVeda Cart Hero",
  "tag": "section",
  "class": "dynamic-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Hero image",
      "info": "Background image for the hero section"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Your Selections"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Review the rituals you have chosen for your journey."
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "checkbox",
      "id": "show_text_overlay",
      "label": "Show text overlay on image",
      "default": true,
      "info": "If enabled, text appears on the image with overlay. If disabled, text appears below the image."
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Border radius",
      "default": 0,
      "info": "Rounded corners for the hero banner"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 40,
      "info": "Dark overlay opacity for text readability (0-100%)"
    },
    {
      "type": "range",
      "id": "container_max_width",
      "min": 1200,
      "max": 1600,
      "step": 50,
      "unit": "px",
      "label": "Container max width",
      "default": 1200,
      "info": "Maximum width of the hero container"
    }
  ],
  "presets": [
    {
      "name": "DinVeda Cart Hero"
    }
  ]
}
{% endschema %}

